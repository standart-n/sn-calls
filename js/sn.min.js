$(function(){var methods;return methods={init:function(options){var def;return options||(options={}),def={content:{},result:{key:""}},$.extend(!0,def,options),$(this).data("sn",def),$(this).snTriggers(),""!==$("#controls").html()?$(this).snEvents({href:"#autoload"}):void 0}},$.fn.sn=function(sn){return sn||(sn={}),methods[sn]?methods[sn].apply(this,Array.prototype.slice.call(arguments,1)):"object"!=typeof sn&&sn?$.error("Метод "+sn+" не существует"):methods.init.apply(this,arguments)}}),$(function(){var methods;return methods={init:function(){return $(this).snPlayer("onClickPlay"),$(this).snPlayer("onClickclose")},onClickclose:function(){return $("#player-close").on("click",function(e){return e.prevEventDefault(),$("#player-wrap").hide()})},onClickPlay:function(){return $("a.play").on("click",function(e){var id,src;return e.prevEventDefault(),id=$(this).data("id"),src=$(this).data("src"),$("#player-wrap").show(),$("#player").html("<audio/>".data("id",id)),audiojs.events.ready(function(){var a,audio;return a=audiojs.createAll(),audio=a[0],$("#player-close").on("click",function(e){return e.prevEventDefault(),audio.pause(),$("#player").html("")}),audio.load(src),audio.play()})})}},$.fn.snPlayer=function(sn){return sn||(sn={}),methods[sn]?methods[sn].apply(this,Array.prototype.slice.call(arguments,1)):"object"!=typeof sn&&sn?$.error("Метод "+sn+" не существует"):methods.init.apply(this,arguments)}}),$(function(){var methods;return methods={init:function(){},sendRequest:function(options){var def,sn;return options||(options={}),def={type:"json",debug:!1,action:"submit",login:$("#inputLogin").val(),password:$("#inputPassword").val(),page:$("#page").val(),id:"",message:"",src:$("#src").val(),dst:$("#dst").val(),date1:$("#date1").val(),date2:$("#date2").val(),limit:$("#limit").val(),order:$("#order").val(),grad:$("#grad").val(),phone:"",show_short_calls:$("#show_short_calls").val(),show_answered:$("#show_answered").val(),show_no_answer:$("#show_no_answer").val(),show_busy:$("#show_busy").val(),show_failed:$("#show_failed").val(),show_hangup:$("#show_hangup").val(),show_playback:$("#show_playback").val(),show_dial:$("#show_dial").val(),show_wait:$("#show_wait").val()},$.extend(!0,def,options),def.debug&&(def.type="text"),sn=$(this).data("sn"),$.ajax({url:"index.php",type:"POST",data:{action:def.action,page:def.page,login:def.login,password:def.password,id:def.id,message:def.message,src:def.src,dst:def.dst,date1:def.date1,date2:def.date2,limit:def.limit,order:def.order,grad:def.grad,phone:def.phone,show_short_calls:def.show_short_calls,show_answered:def.show_answered,show_no_answer:def.show_no_answer,show_busy:def.show_busy,show_failed:def.show_failed,show_hangup:def.show_hangup,show_playback:def.show_playback,show_dial:def.show_dial,show_wait:def.show_wait,key:sn.result.key},dataType:def.type,timeout:1e4,beforeSend:function(){return $("#loading").show()},success:function(s){return"object"==typeof s?$.extend(!0,sn.result,s):(def.debug&&alert(s),sn.result=s),$(this).data("sn",sn),"object"==typeof sn.result&&(sn.result.alert&&alert(sn.result.alert),sn.result.callback&&$(this).snEvents({href:"#"+sn.result.callback})),$("#loading").hide()},error:function(){}})}},$.fn.snAjax=function(sn){return sn||(sn={}),methods[sn]?methods[sn].apply(this,Array.prototype.slice.call(arguments,1)):"object"!=typeof sn&&sn?$.error("Метод "+sn+" не существует"):methods.init.apply(this,arguments)}}),$(function(){var methods;return methods={init:function(){return $(this).snConf(main)},main:function(){var sn;return sn=$(this).data(sn),$.ajax({url:"sn-project/settings/main.json",async:!1,dataType:"json",success:function(s){return $.extend(!0,sn,s),$(this).data("sn",sn)}})}},$.fn.snConf=function(sn){return sn||(sn={}),methods[sn]?methods[sn].apply(this,Array.prototype.slice.call(arguments,1)):"object"!=typeof sn&&sn?$.error("Метод "+sn+" не существует"):methods.init.apply(this,arguments)}}),$(function(){var methods;return methods={init:function(options){var def,href,sn,th;switch(def={href:"none"},$.extend(!0,def,options),th=$(this),sn=$(this).data("sn"),href=def.href,href.replace(/(.*)#(.*)/,"$2")){case"autoload":return $("#dp1").datepicker(),$("#dp2").datepicker(),$(this).snEvents({href:"#fbRequest"}),$(this).snPlayer();case"signin":return $("#signin-error").hide(),$(this).snAjax("sendRequest",{action:"signin",debug:!1});case"afterSignin":if(sn.result)return sn.result.response?(sn.result.controls&&$("#controls").html(sn.result.controls),$("#signin").empty(),$(this).snTriggers("controls"),$("#dp1").datepicker(),$("#dp2").datepicker(),$(this).snAjax("sendRequest",{action:"submit",debug:!1}),$(this).snPlayer()):($("#inputLogin").val(""),$("#inputPassword").val(""),$("#signin-error").show());break;case"submit":return $(this).snAjax("sendRequest",{action:"submit",debug:!0});case"afterSubmit":if(sn.result)return sn.result.table&&($("#table").html(sn.result.table),$(this).snTriggers("sort"),$(this).snTriggers("detail"),$(this).snPlayer("onClickPlay")),sn.result.stat&&$("#stat").html(sn.result.stat),sn.result.pagination&&($("#pagination").html(sn.result.pagination),$(this).snTriggers("pagination")),$(this).snEvents({href:"#fbRequest"});break;case"fbRequest":return $(".no-fb").each(function(){return""!==$(this).val()?(th.snAjax("sendRequest",{action:"phone",phone:$(this).val(),debug:!1}),$(this).removeCLass("no-fb")):void 0});case"afterFbRequest":if(sn.result&&sn.result.response&&sn.result.response.hash)return $("."+sn.result.response.hash).html(sn.result.response.caption);break;case"close":return $(this).hide()}}},$.fn.snEvents=function(sn){return sn||(sn={}),methods[sn]?methods[sn].apply(this,Array.prototype.slice.call(arguments,1)):"object"!=typeof sn&&sn?$.error("Метод "+sn+" не существует"):methods.init.apply(this,arguments)}}),$(function(){var methods;return methods={init:function(){return""!==$("#controls").html()&&$(this).snTriggers("controls"),""!==$("#table").html()&&($(this).snTriggers("sort"),$(this).snTriggers("detail")),""!==$("#pagination").html()&&$(this).snTriggers("pagination"),""!==$("#signin").html()?$(this).snTriggers("signin"):void 0},controls:function(){return $(this).snTriggers("submit"),$(this).snTriggers("cb"),$(this).snTriggers("limit"),$(this).snTriggers("filters")},signin:function(){var th;return th=$(this),$("#fSignin").on("submit",function(e){return e.preventDefault(),th.snEvents({href:"#signin"})})},submit:function(){var th;return th=$(this),$("#fSubmit").on("submit",function(e){return e.preventDefault(),$("page").val(1),th.snEvents({href:"#submit"})}),$("#submit").on("click",function(e){return e.preventDefault(),$("page").val(1),th.snEvents({href:"#submit"})})},limit:function(){var sn,th;return th=$(this),sn=$(this).data("sn"),$(".limit a").on("click",function(e){return e.preventDefault(),$(this).addClass("active").siblings().removeClass("active"),$("#limit").val($(this).data("limit")),$("page").val(1),th.snEvents({href:"#submit"})})},cb:function(){var th;return th=$(this),$(".cb").on("click",function(e){return e.preventDefault(),$(this).is(":checked")?$("#"+$(this).data("cb")).val("on"):$("#"+$(this).data("cb")).val("off"),$("#page").val(1),th.snEvents({href:"#submit"})})},filters:function(){var sn,th;return th=$(this),sn=$(this).data("sn"),$(".filters li a").on("click",function(e){return e.preventDefault(),$(this).data(false)?($("i",this).removeClass("icon-ok").addClass("icon-none"),$(this).data("value","off"),$("#"+$(this).data("cb")).val("off")):($("i",this).removeClass("icon-none").addClass("icon-ok"),$(this).data("value","on"),$("#"+$(this).data("cb")).val("on")),$("#page").val(1),th.snEvents({href:"#submit"})})},detail:function(){var th;return th=$(this),$("a.tel").on("click",function(e){return e.preventDefault(),$("#dst").val($(this).html()),$("#src").val($(this).html()),$("#page").val(1),th.snEvents({href:"#submit"})})},sort:function(){var th;return th=$(this),$("a.sort").on("click",function(e){return e.preventDefault(),$("#order").val($(this).val("order")),$("#grad").val($(this).val("grad")),$("#page").val(1),th.snEvents({href:"#submit"})})},pagination:function(){var th;return th=$(this),$("a#prev").on("click",function(e){return e.preventDefault(),$("#page").val(1*$("#page").val()-1),th.snAjax("sendRequest",{action:"signin",debug:!1})}),$("a.list").on("click",function(e){return e.preventDefault(),$("#page").val($(this).data("page")),th.snAjax("sendRequest",{action:"signin",debug:!1})}),$("a#next").on("click",function(e){return e.preventDefault(),$("#page").val(1*$("#page").val()+1),th.snAjax("sendRequest",{action:"signin",debug:!1})})}},$.fn.snTriggers=function(sn){return sn||(sn={}),methods[sn]?methods[sn].apply(this,Array.prototype.slice.call(arguments,1)):"object"!=typeof sn&&sn?$.error("Метод "+sn+" не существует"):methods.init.apply(this,arguments)}});